let __supabase_functions_js=require("@supabase/functions-js"),__supabase_postgrest_js=require("@supabase/postgrest-js"),__supabase_realtime_js=require("@supabase/realtime-js"),__supabase_storage_js=require("@supabase/storage-js"),__supabase_auth_js=require("@supabase/auth-js");const version="2.89.0";let JS_ENV="";JS_ENV="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${JS_ENV}/${version}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function toPropertyKey(e){var t=toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _defineProperty(e,t,r){return(t=toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),resolveHeadersConstructor=()=>Headers,fetchWithAuth=(e,t,r)=>{const s=resolveFetch(r),n=resolveHeadersConstructor();return async(r,o)=>{var a;const i=null!==(a=await t())&&void 0!==a?a:e;let u=new n(null===o||void 0===o?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${i}`),s(r,_objectSpread2(_objectSpread2({},o),{},{headers:u}))}};function ensureTrailingSlash(e){return e.endsWith("/")?e:e+"/"}function applySettingDefaults(e,t){var r,s;const{db:n,auth:o,realtime:a,global:i}=e,{db:u,auth:c,realtime:l,global:h}=t,p={db:_objectSpread2(_objectSpread2({},u),n),auth:_objectSpread2(_objectSpread2({},c),o),realtime:_objectSpread2(_objectSpread2({},l),a),storage:{},global:_objectSpread2(_objectSpread2(_objectSpread2({},h),i),{},{headers:_objectSpread2(_objectSpread2({},null!==(r=null===h||void 0===h?void 0:h.headers)&&void 0!==r?r:{}),null!==(s=null===i||void 0===i?void 0:i.headers)&&void 0!==s?s:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function validateSupabaseUrl(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ensureTrailingSlash(t))}catch(r){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var SupabaseAuthClient=class extends __supabase_auth_js.AuthClient{constructor(e){super(e)}},SupabaseClient=class{constructor(e,t,r){var s,n;this.supabaseUrl=e,this.supabaseKey=t;const o=validateSupabaseUrl(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const a=`sb-${o.hostname.split(".")[0]}-auth-token`,i=applySettingDefaults(null!==r&&void 0!==r?r:{},{db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:_objectSpread2(_objectSpread2({},DEFAULT_AUTH_OPTIONS),{},{storageKey:a}),global:DEFAULT_GLOBAL_OPTIONS});var u;(this.storageKey=null!==(s=i.auth.storageKey)&&void 0!==s?s:"",this.headers=null!==(n=i.global.headers)&&void 0!==n?n:{},i.accessToken)?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(u=i.auth)&&void 0!==u?u:{},this.headers,i.global.fetch);this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(_objectSpread2({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new __supabase_postgrest_js.PostgrestClient(new URL("rest/v1",o).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch}),this.storage=new __supabase_storage_js.StorageClient(this.storageUrl.href,this.headers,this.fetch,null===r||void 0===r?void 0:r.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new __supabase_functions_js.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,r=this;if(r.accessToken)return await r.accessToken();const{data:s}=await r.auth.getSession();return null!==(e=null===(t=s.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:o,flowType:a,lock:i,debug:u,throwOnError:c},l,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:_objectSpread2(_objectSpread2({},p),l),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,flowType:a,lock:i,debug:u,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new __supabase_realtime_js.RealtimeClient(this.realtimeUrl.href,_objectSpread2(_objectSpread2({},e),{},{params:_objectSpread2(_objectSpread2({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=r,this.realtime.setAuth(r))}};const createClient=(e,t,r)=>new SupabaseClient(e,t,r);function shouldShowDeprecationWarning(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18}shouldShowDeprecationWarning()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217"),Object.defineProperty(exports,"FunctionRegion",{enumerable:!0,get:function(){return __supabase_functions_js.FunctionRegion}}),Object.defineProperty(exports,"FunctionsError",{enumerable:!0,get:function(){return __supabase_functions_js.FunctionsError}}),Object.defineProperty(exports,"FunctionsFetchError",{enumerable:!0,get:function(){return __supabase_functions_js.FunctionsFetchError}}),Object.defineProperty(exports,"FunctionsHttpError",{enumerable:!0,get:function(){return __supabase_functions_js.FunctionsHttpError}}),Object.defineProperty(exports,"FunctionsRelayError",{enumerable:!0,get:function(){return __supabase_functions_js.FunctionsRelayError}}),Object.defineProperty(exports,"PostgrestError",{enumerable:!0,get:function(){return __supabase_postgrest_js.PostgrestError}}),exports.SupabaseClient=SupabaseClient,exports.createClient=createClient,Object.keys(__supabase_auth_js).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return __supabase_auth_js[e]}})}),Object.keys(__supabase_realtime_js).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return __supabase_realtime_js[e]}})});